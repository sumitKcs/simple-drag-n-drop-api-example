<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>drag n drop with localstorage</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            color: grey;
            font-weight: bold;
        }

        main {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            row-gap: 5rem;
            width: 100%;
            height: 100%;
        }

        section {
            display: flex;
            justify-content: center;
            column-gap: 2rem;
            width: 50%;
        }

        section div {
            width: 20vw;
            height: 50vh;
            border: .5rem dotted blue;
            padding: 2rem;
            display: flex;
            justify-content: flex-start;
            flex-direction: column;
            row-gap: 1rem;
        }

        p {
            text-align: center;
            border: 2px solid yellow;
            padding: .5rem;

        }

        button {
            background-color: rgb(56, 21, 21);
            padding: .5rem 2rem;
            border-radius: .5rem;
        }

        input {
            padding: .3rem 1rem;
            border: none;
            border-radius: .5rem;
            height: 5vh;
            width: 60%;
            font-size: large;

        }

        input:focus {
            outline: transparent;

        }
    </style>

</head>

<body>
    <!-- important
    1. enumerated attribute - draggable="true" 
    2. Drag Events -
        a. ondragstart
        b. ondragOver
        c. Ondrop
        d. ondragend
    3. Drag's data - 
        ~ e.dataTransfer.setData("text/plain", ev.target.innerText)
        ~ e.dataTransfer.getData("text/plain")
    4. Drop Effect -  
        ~ ev.dataTransfer.dropEffect = "copy/move/link"
        ~ ev.dataTransfer.effectAllowed = "copy/move/link";
-->
    <main>
        <section>
            <input id="input" aria-label="input box" type="text" placeholder="Enter a task" />
            <button id="button" onclick="add()">ADD</button>
        </section>
        <section>
            <div id="firstBox" ondrop="drop_handler(event)" ondragover="dragover_handler(event)">
            </div>
            <div id="secondBox" ondrop="drop_handler(event)" ondragover="dragover_handler(event)">

            </div>
        </section>
    </main>

    <script>
        let ls = null;
        if (window.localStorage && localStorage.getItem("tasks")) {
            ls = localStorage.getItem("tasks")
        }
        const taskList = ls ? JSON.parse(ls) : [];




        function dragstart_handle(e) {
            e.dataTransfer.setData("text/plain", e.target.id);
            e.dataTransfer.effectAllowed = "move"
        }
        function dragover_handler(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = "move";

        }
        function drop_handler(e) {
            e.preventDefault();
            let data = e.dataTransfer.getData("text/plain");
            e.target.appendChild(document.getElementById(data))
        }
        function add() {
            const input = document.getElementById("input");
            const firstBox = document.getElementById("firstBox");

            const value = input.value;

            const task = document.createElement("p")
            task.draggable = true
            task.ondragstart = dragstart_handle;
            task.ondragover = dragover_handler;
            task.innerText = value;
            task.id = value.trim().replace(" ", "")

            firstBox.appendChild(task)

            taskList.push(value);
            localStorage.setItem("tasks", JSON.stringify(taskList))

            input.value = ""

        }

        window.addEventListener("keydown", function (event) {
            if (event.keyCode == 13 && event.target.id == "input") {
                event.preventDefault();
                document.getElementById("button").click()
            }
        })

        function renderTasks() {
            const firstBox = document.getElementById("firstBox");
            const fragment = document.createDocumentFragment();
            taskList.map((task) => {
                const item = document.createElement("p")
                item.draggable = true
                item.ondragstart = dragstart_handle;
                item.ondragover = dragover_handler;
                item.innerText = task;
                item.id = task.trim().replace(" ", "")
                fragment.appendChild(item)

            })
            firstBox.appendChild(fragment)
            console.log("render")


        }

        renderTasks()
    </script>
</body>

</html>